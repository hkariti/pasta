map $http_upgrade $connection_upgrade {
    default upgrade;
    ''      close;
}

server {
        listen 80 default_server;

        root /usr/share/nginx/html;
        index index.html index.htm;

        server_name pasta.;

        location / {
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection $connection_upgrade;
                proxy_pass http://localhost:6680;
        }
        location /plex {
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection $connection_upgrade;
                proxy_pass http://localhost:32400/web;
        }
        location /transmission {
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection $connection_upgrade;
                proxy_pass http://localhost:9091;
        }
        location /couchpotato {
                return 301 http://$server_name:5050;
        }
        location /sickrage {
                return 301 http://$server_name:8081;
        }
        location /headphones {
                return 301 http://$server_name:8181;
        }
}
